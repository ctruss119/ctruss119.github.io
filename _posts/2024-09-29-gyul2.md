---
layout: post
title: "학교에 있는 4090 서버에 Docker Container 생성하기"
---

<h2>목차</h2>
<ul>
  <li><a href="#section1">1. 도커의 개념 이해하기 </a></li>
  <li><a href="#section2">2. 도커 생성하기 </a></li>
  <li><a href="#section3">3. 도커 관련 명령어 </a></li>
  <li><a href="#section4">4. 도커 파일 작성하기 </a></li>
</ul>

# <a id="section1"></a>1. 도커의 개념 이해하기 

## (1) 컨테이너
프로세스 격리 기술중 하나로 **사용자가 사용할 라이브러리, 시스템 도구, 코드, 환경 설정 등 소프트웨어 실행에 필요한 모든 것을 패키징한 계층**이다. 여러 종류의 컨테이너가 동일한 시스템에서 실행되고  OS를 다른 컨테이너와 공유할 수 있으며, 각 컨테이너는 사용자 공간에서 독립적인 프로세스로 실행된다.   

(1) 가상환경(VM)보다 메모리 공간을 적게 차지하고 더 많은 Application을 처리할 수 있고   
(2) 다른 컨테이너나 시스템과 충돌 없이 동작할 수 있고,   
(3) 더 적은 수의 vm또는 os를 필요로 하고,   
(4) 시스템의 커널을 공유하므로 가상 머신보다 빠르게 시작하고 멈출 수 있고,   
(5) 어떤 운영환경으로도 배포, 이동이 쉽기 때문에   
이미 다양한 어플리케이션들이 컨테이너 환경에서 실행되고 있다.   


**다만 이런 컨테이너가 많을수록 관리가 어려워지는데 이를 해결하기 위해 나온 것이 도커다.**


## (2) 도커      
컨테이너 가상화 기술로, 응용 프로그램과 의존성을 하나의 컨테이너에 패키징해 컨테이너 단위로 배포하고 실행할 수 있도록 하는 오픈소스 플랫폼. 한 컴퓨터 안에 여러개의 시스템 및 환경설정들을 충돌하지 않고 동시에 사용할 수 있도록 격리시켜 사용할 수 있다. 호스트OS의 커널을 공유해 다양한 어플리케이션을 설치/운영하여 하나의 서버처럼 사용할 수 있다.   
기존의 가상머신(가상환경을 활용해 새로운 os를 깔아 설치)과 달리 도커는 os전체를 가상화하지 않고 호스트 OS의 커널을 공유하면서 필요한 실행 환경만을 독립적으로 분리해 사용한다. 이로 인해 설치 용량이 작고 실행 속도가 빠르다.   

* 핵심 용어
  * OS 가상화   
    사용하려는 OS를 커널만 공유하여 프로세스로 실행하는 것. 
  * 커널   
    하드웨어 자원을 관리하고 하드웨어와 프로세스 사이의 인터페이스 역할을 수행하는 요소
  * 레이어   
    기존 도커 이미지에서 추가적인 파일이 필요할 때 파일을 추가하기 위한 개념
  * 도커 이미지   
    컨테이너 실행에 필요한 파일과 설정값 등을 포함하고 있는 것으로 같은 이미지로 여러 개의 컨테이너 생성 가능
  * 도커 컨테이너   
    호스트 OS 상에 어플리케이션을 동작시키기 위해 필요한 라이브러리나 애플리케이션을 하나로 모은 것, 또는 도커 임미지를 실행한 상태 


* 장점 
  * 빠른 설치   
    어플리케이션을 설치하고 사용하는 것에 최소한의 시간과 용량을 소비
  * 이식성   
    어플리케이션의 설치 파일들이 하나의 컨테이너에 존재하기 때문에 호스트의 커널이나 플랫폼 버전에 관계 없이 도커만 실행할ㄴㄹ수 있음면 사용 가능함ㅁ. 개발 환경과 실제 서버 환경이 달라 생기는 문제가 없다. 도커를 사용하면 개발자가 특정 소프트웨어를 개발한 환경과 동일한 환경을 어디서든 쉽게 재현할 수 있기 때문에, 코드가 어디서든 동일하게 작동하는 것을 보장할 수 있다. 
  * 컴포넌트 재사용   
    이전 레이어에서 컴포넌트들을 재사용하기 때문에 도커를 가볍게 만들 수 있음ㅁ
  * 쉬운 유지관리   
    어플리케이션 종속성에 관한 문제들에 대해 유지관리가 용의함

## (3) VM과 도커의 차이점 
### 도커의 아키텍쳐
하드웨어의 자원을 나눠 사용하는 것이 아니라 **호스트 위에 도커 엔진을 통해 바로 애플리케이션과 애플리케이션에서 필요로 하는 자원을 패키징화하여 바로 사용하는 개념**이기 때문에 **소모되는 자원이 VM에 비해 매우 작음.** 애플리케이션에서 필요로하는 자원은 도커 이미지로 도커 레지스트리 또는 도커 허브에 저장되어 있는데 도커 이미지에 접근하여 이를 실행해 컨테이너를 생성할 수 있다. 컨테이너를 생성하여 실행하게 되면 애플리케이션 배포가 완료된다. 

### VM과 VM의 아키텍쳐 
VM은 물리적 시스템 OS 위에 논리적 가상 OS를 올려서 독립적인 동작이 가능하도록 하는 시스템 차원의 가상 머신   
* 호스트OS: VM이 설치되는 기본 OS (맥, 리눅스, 윈도우 등)
* 게스트 OS: 호스트 OS위에 설치되는 가상 OS
* 하이퍼바이저: 호스트OS 위에 VM을 생성하고 실행하는 프로세스 (VMware, virturebox 등)
* 각 VM이 동일한 OS를 사용해도 데이터를 공유하지 않음 -> 독립된 실행환경   

VM의 아키텍쳐는 하드웨어 자원을 공유해 사용하는 것임. 때문에 하나의 가상공간이 생성될 때마다 하드웨어의 자원을 일부 공유받아 사용하게 됨. 다만 각각의 가상공간은 서로 간섭하지 않기 때문에 한 공간에서의 문제가 다른 공간에서까지 영향을 끼치지 않는다. 

### 도커와 VM의 차이점 
VM은 각각의 공간이 하드웨어의 자원을 일부 공유받아 서로 다른 공간처럼, 개별적인 공간인 것처럼 사용한다. 그러므로 각 가상공간마다 OS를 설치해야 한다.    
도커는 하나의 OS에서 각각의 컨테이너를 띄워 앱을 실행하는 구조다.   
속도적인 측면에서는 도커가 유리, OS의 보안적인 측면에서는 VM이 유리함.

---------------

## (4) 이미지
컨테이너를 실행하는 데 필요한 소프트웨어와 환경이 정의된 일종의 "템플릿"이다. 이미지는 컨테이너를 만들기 위한 기본 단위이며, 다양한 소프트웨어와 의존성 등이 모두 포함된 상태다. 도커 이미지는 실행 가능한 상태로 저장되며, 이를 기반으로 컨테이너를 생성할 수 있다.

**이미지의 주요 특징**
불변성: 이미지는 한 번 만들어지면 수정할 수 없고, 항상 동일한 상태를 보장한다.
레이어 구조: 도커 이미지는 레이어(layer)로 구성되며, 각 레이어는 서로 의존하고 있습니다. 이로 인해 이미지를 효율적으로 저장하고 전송할 수 있다. 
저장소(Docker Hub): 이미지를 저장하고 공유할 수 있는 저장소가 있으며, 도커 허브(Docker Hub)를 통해 여러 사람이 이미지를 쉽게 다운로드할 수 있다. 

[참고자료](https://www.youtube.com/watch?v=WEcjf6UMzmQ)

# <a id="section2"></a>2. 도커 생성하기
# <a id="section3"></a>3. 도커 관련 명령어
# <a id="section4"></a>4. 도커 파일 작성하기

### 4. 도커파일
**도커파일(Dockerfile)**은 도커 이미지를 만들기 위한 설정 파일입니다. 이 파일에는 도커 이미지의 빌드 과정이 순차적으로 정의되어 있습니다. 쉽게 말해, 도커파일은 컨테이너 환경을 만들기 위해 어떤 OS를 사용할지, 어떤 소프트웨어를 설치할지, 환경 설정을 어떻게 할지 등을 기술한 스크립트입니다.

도커파일의 구성:
FROM: 베이스 이미지(기본적으로 사용할 운영체제 또는 환경)를 지정합니다.
RUN: 컨테이너 안에서 실행할 명령을 정의합니다. 예를 들어, 필요한 소프트웨어 설치 명령 등을 추가할 수 있습니다.
COPY: 파일을 호스트 시스템에서 컨테이너로 복사하는 명령입니다.
CMD: 컨테이너가 시작될 때 실행될 명령을 정의합니다.


```
#도커파일의 예시
# 베이스 이미지를 선택
FROM ubuntu:latest

# 소프트웨어 패키지 업데이트 및 설치
RUN apt-get update && apt-get install -y nginx

# 호스트 시스템의 파일을 컨테이너로 복사
COPY ./index.html /var/www/html/index.html

# 컨테이너가 실행될 때 Nginx 서버를 시작
CMD ["nginx", "-g", "daemon off;"]
````

